<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>체르 갤러리</title>
<style>
  /* 기본 & 리셋 */
  * {
    box-sizing: border-box;
  }
  body {
    margin: 0 auto;
    max-width: 480px;
    font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, system-ui, sans-serif;
    line-height: 1.5;
    color: var(--text-color);
    background-color: var(--bg-color);
    -webkit-tap-highlight-color: transparent;
    min-height: 100vh;
    padding-bottom: 70px;
    transition: background-color 0.3s ease, color 0.3s ease;
  }
  body.light {
    --bg-color: #f0f2f7;
    --text-color: #222;
    --primary-color: #3366ff;
    --input-bg: #fff;
    --input-border: #c4c9dd;
    --btn-bg: linear-gradient(135deg, #3366ff, #254eda);
    --btn-hover-bg: linear-gradient(135deg, #254eda, #1e3bb3);
    --modal-bg: #fff;
    --comment-bg: #f8fbff;
    --comment-border: #d5dbed;
    --header-bg: #e6ebff;
  }
  body.dark {
    --bg-color: #12161f;
    --text-color: #eee;
    --primary-color: #5599ff;
    --input-bg: #1f2233;
    --input-border: #394165;
    --btn-bg: linear-gradient(135deg, #5599ff, #3366ff);
    --btn-hover-bg: linear-gradient(135deg, #3366ff, #254eda);
    --modal-bg: #1f2233;
    --comment-bg: #2a2e45;
    --comment-border: #394165;
    --header-bg: #1e2239;
  }
  /* 헤더 */
  header {
    position: sticky;
    top: 0;
    background: var(--header-bg);
    display: flex;
    align-items: center;
    padding: 10px 16px;
    gap: 10px;
    z-index: 150;
    border-bottom: 1px solid var(--input-border);
  }
  header h1 {
    margin: 0;
    font-weight: 700;
    font-size: 1.5rem;
    flex-grow: 1;
    user-select: none;
  }

  /* 버거 메뉴 버튼 */
  #burgerMenuBtn {
    width: 30px;
    height: 24px;
    border: none;
    background: transparent;
    cursor: pointer;
    display: flex;
    flex-direction: column;
    justify-content: space-between;
  }
  #burgerMenuBtn span {
    display: block;
    height: 3px;
    background: var(--primary-color);
    border-radius: 2px;
  }

  /* 로그인 버튼 (버거바 옆) */
  #loginBtn {
    padding: 6px 14px;
    font-weight: 600;
    font-size: 1rem;
    border-radius: 6px;
    border: none;
    cursor: pointer;
    background: var(--btn-bg);
    color: white;
    transition: background 0.3s;
  }
  #loginBtn:hover {
    background: var(--btn-hover-bg);
  }

  /* 로그아웃 버튼 */
  #logoutBtn {
    padding: 6px 14px;
    font-weight: 600;
    font-size: 1rem;
    border-radius: 6px;
    border: none;
    cursor: pointer;
    background: var(--btn-bg);
    color: white;
    transition: background 0.3s;
    margin-left: auto;
  }
  #logoutBtn:hover {
    background: var(--btn-hover-bg);
  }

  /* 사이드 메뉴 */
  #sideMenu {
    position: fixed;
    top: 0;
    left: -240px;
    width: 220px;
    height: 100vh;
    background: var(--modal-bg);
    box-shadow: 2px 0 8px rgb(0 0 0 / 0.15);
    padding: 20px 16px;
    box-sizing: border-box;
    transition: left 0.3s ease;
    z-index: 200;
  }
  #sideMenu.open {
    left: 0;
  }
  #sideMenu ul {
    list-style: none;
    padding: 0;
    margin: 0;
  }
  #sideMenu ul li {
    margin-bottom: 12px;
  }
  #sideMenu ul li button {
    width: 100%;
    padding: 10px;
    border: none;
    border-radius: 6px;
    background: var(--btn-bg);
    color: white;
    font-weight: 600;
    cursor: pointer;
    transition: background 0.3s;
  }
  #sideMenu ul li button:hover {
    background: var(--btn-hover-bg);
  }

  /* 메인 영역 */
  main {
    padding: 10px 16px 70px;
  }

  /* 검색창 */
  #searchSection {
    margin-bottom: 12px;
    display: flex;
    gap: 8px;
  }
  #searchInput {
    flex-grow: 1;
    padding: 10px 14px;
    font-size: 1rem;
    border-radius: 8px;
    border: 1.5px solid var(--input-border);
    background: var(--input-bg);
    color: var(--text-color);
    outline-offset: 2px;
  }
  #searchBtn {
    padding: 10px 16px;
    font-weight: 600;
    border-radius: 8px;
    border: none;
    background: var(--btn-bg);
    color: white;
    cursor: pointer;
    transition: background 0.3s;
  }
  #searchBtn:hover {
    background: var(--btn-hover-bg);
  }

  /* 카테고리 선택 */
  #categorySelect {
    width: 100%;
    padding: 8px 12px;
    font-size: 1rem;
    margin-bottom: 14px;
    border-radius: 8px;
    border: 1.5px solid var(--input-border);
    background: var(--input-bg);
    color: var(--text-color);
  }

  /* 게시글 리스트 */
  #postList {
    list-style: none;
    padding: 0;
    margin: 0;
  }
  #postList li {
    padding: 12px 16px;
    border-radius: 10px;
    background: var(--comment-bg);
    border: 1.5px solid var(--comment-border);
    margin-bottom: 12px;
    cursor: pointer;
    font-weight: 600;
    display: flex;
    flex-direction: column;
    transition: background 0.2s, color 0.2s;
  }
  #postList li:hover {
    background: var(--primary-color);
    color: white;
  }
  #postList li .post-title {
    font-weight: 700;
    font-size: 1.1rem;
    margin-bottom: 6px;
  }
  #postList li .post-preview {
    font-weight: 400;
    font-size: 0.9rem;
    color: #666;
  }

  /* 게시글 상세 */
  #postDetail {
    display: none;
    margin-top: 20px;
  }
  #postDetail h3 {
    margin-top: 0;
    font-weight: 700;
  }
  #postDetail .post-meta {
    font-size: 0.85rem;
    color: #777;
    margin-bottom: 12px;
  }
  #postContent {
    white-space: pre-wrap;
    margin-bottom: 20px;
  }
  #backToListBtn {
    background: transparent;
    border: none;
    color: var(--primary-color);
    font-weight: 600;
    cursor: pointer;
    margin-bottom: 20px;
  }
  #backToListBtn:hover {
    text-decoration: underline;
  }

  /* 댓글 섹션 */
  #commentsSection {
    margin-top: 30px;
  }
  #commentsSection h4 {
    margin-bottom: 12px;
    font-weight: 600;
  }
  #commentsList {
    list-style: none;
    padding: 0;
    margin: 0;
    max-height: 240px;
    overflow-y: auto;
  }
  #commentsList li {
    background: var(--comment-bg);
    border: 1px solid var(--comment-border);
    border-radius: 8px;
    padding: 12px 16px;
    margin-bottom: 10px;
  }
  #commentsList li .author {
    font-weight: 700;
    font-size: 0.9rem;
    margin-bottom: 6px;
  }
  #commentsList li .content {
    white-space: pre-wrap;
    font-size: 0.95rem;
  }
  #commentsList li .createdAt {
    font-size: 0.75rem;
    color: #777;
    margin-top: 6px;
  }

  /* 댓글 작성 폼 */
  #commentForm {
    display: flex;
    margin-top: 14px;
  }
  #commentInput {
    flex-grow: 1;
    padding: 10px 14px;
    border: 1.5px solid var(--input-border);
    border-radius: 8px 0 0 8px;
    font-size: 1rem;
    background: var(--input-bg);
    color: var(--text-color);
    outline-offset: 2px;
  }
  #commentSubmitBtn {
    padding: 0 20px;
    background: var(--btn-bg);
    border: none;
    color: white;
    font-weight: 700;
    border-radius: 0 8px 8px 0;
    cursor: pointer;
    transition: background 0.3s;
  }
  #commentSubmitBtn:hover {
    background: var(--btn-hover-bg);
  }

  /* 새 글 작성 버튼 - 오른쪽 하단 고정 */
  #showWritePostBtn {
    position: fixed;
    bottom: 20px;
    right: 20px;
    background: var(--btn-bg);
    border: none;
    color: white;
    padding: 14px 22px;
    font-weight: 700;
    font-size: 1.1rem;
    border-radius: 50px;
    cursor: pointer;
    box-shadow: 0 4px 12px rgb(0 0 0 / 0.2);
    transition: background 0.3s, transform 0.15s;
    z-index: 90;
  }
  #showWritePostBtn:hover {
    background: var(--btn-hover-bg);
    transform: scale(1.05);
  }
  #showWritePostBtn:active {
    transform: scale(0.95);
  }

  /* 오류 메시지 */
  .errorMsg {
    color: #e53e3e;
    font-size: 0.85rem;
    margin-bottom: 8px;
    text-align: center;
  }

  /* 게시글 작성 섹션 */
  #writePostSection {
    display: none;
    margin-top: 20px;
  }
  #writePostSection input[type="text"],
  #writePostSection textarea,
  #writePostSection select {
    width: 100%;
    padding: 10px 14px;
    margin-bottom: 12px;
    font-size: 1rem;
    border-radius: 8px;
    border: 1.5px solid var(--input-border);
    background: var(--input-bg);
    color: var(--text-color);
    outline-offset: 2px;
    box-sizing: border-box;
  }
  #writePostSection textarea {
    resize: vertical;
    height: 120px;
  }
  #writePostSection .btn-group {
    display: flex;
    gap: 10px;
  }
  #submitPostBtn,
  #cancelPostBtn {
    flex-grow: 1;
    padding: 12px 0;
    border: none;
    border-radius: 8px;
    font-weight: 700;
    cursor: pointer;
    color: white;
    background: var(--btn-bg);
    transition: background 0.3s;
  }
  #submitPostBtn:hover,
  #cancelPostBtn:hover {
    background: var(--btn-hover-bg);
  }
  #cancelPostBtn {
    background: #aaa;
  }
  #cancelPostBtn:hover {
    background: #888;
  }

  /* 라이트/다크 모드 토글 버튼 */
  #toggleThemeBtn {
    position: fixed;
    top: 10px;
    left: 10px;
    z-index: 110;
    background: var(--btn-bg);
    border: none;
    color: white;
    padding: 8px 12px;
    font-size: 1.2rem;
    border-radius: 6px;
    cursor: pointer;
    transition: background 0.3s;
  }
  #toggleThemeBtn:hover {
    background: var(--btn-hover-bg);
  }
</style>
</head>
<body class="light">
<header>
  <button id="burgerMenuBtn" aria-label="메뉴 열기" aria-expanded="false" aria-controls="sideMenu">
    <span></span>
    <span></span>
    <span></span>
  </button>
  <h1>체르 갤러리</h1>
  <button id="loginBtn" style="display:none;">로그인</button>
  <button id="logoutBtn" style="display:none;">로그아웃</button>
</header>

<!-- 사이드 메뉴 -->
<nav id="sideMenu" aria-hidden="true" tabindex="-1">
  <ul>
    <li><button>임시 버튼1</button></li>
    <li><button>임시 버튼2</button></li>
    <li><button>임시 버튼3</button></li>
  </ul>
</nav>

<main>
  <!-- 검색 + 카테고리 -->
  <section id="searchSection">
    <input id="searchInput" type="search" placeholder="게시물 검색" aria-label="게시물 검색" />
    <button id="searchBtn" aria-label="검색 실행">검색</button>
  </section>

  <select id="categorySelect" aria-label="카테고리 선택">
    <option value="">전체 카테고리</option>
    <option value="자유">자유</option>
    <option value="공지">공지</option>
    <option value="질문">질문</option>
  </select>

  <!-- 게시글 리스트 -->
  <ul id="postList" aria-live="polite" aria-relevant="additions"></ul>

  <!-- 게시글 상세 -->
  <article id="postDetail" tabindex="-1" aria-label="게시글 상세 보기">
    <button id="backToListBtn">&lt; 목록으로</button>
    <h3 id="postTitle"></h3>
    <div class="post-meta">작성자: <span id="postAuthor"></span> | 작성일: <span id="postDate"></span></div>
    <div id="postContent"></div>

    <!-- 댓글 섹션 -->
    <section id="commentsSection" aria-label="댓글 섹션">
      <h4>댓글</h4>
      <ul id="commentsList"></ul>
      <form id="commentForm">
        <input id="commentInput" placeholder="댓글 작성..." autocomplete="off" aria-label="댓글 내용 입력" />
        <button id="commentSubmitBtn" type="submit">등록</button>
      </form>
    </section>
  </article>

  <!-- 게시글 작성 -->
  <section id="writePostSection" aria-label="게시글 작성" style="display:none;">
    <input type="text" id="newPostTitle" placeholder="제목" aria-label="새 게시물 제목" />
    <textarea id="newPostContent" placeholder="내용" aria-label="새 게시물 내용"></textarea>
    <select id="newPostCategory" aria-label="카테고리 선택">
      <option value="자유">자유</option>
      <option value="공지">공지</option>
      <option value="질문">질문</option>
    </select>
    <div class="btn-group">
      <button id="submitPostBtn">글 작성</button>
      <button id="cancelPostBtn" class="cancel-btn">취소</button>
    </div>
  </section>
</main>

<!-- 새 글 작성 버튼 -->
<button id="showWritePostBtn" title="새 글 작성">글쓰기 ✍️</button>

<!-- 라이트/다크 모드 토글 -->
<button id="toggleThemeBtn" title="라이트 / 다크 모드 전환">🌙</button>

<script>
  const SERVER_URL = 'http://foxbox.r-e.kr';

  // DOM 요소
  const body = document.body;
  const toggleThemeBtn = document.getElementById('toggleThemeBtn');

  const burgerMenuBtn = document.getElementById('burgerMenuBtn');
  const sideMenu = document.getElementById('sideMenu');

  const loginBtn = document.getElementById('loginBtn');
  const logoutBtn = document.getElementById('logoutBtn');

  const searchInput = document.getElementById('searchInput');
  const searchBtn = document.getElementById('searchBtn');
  const categorySelect = document.getElementById('categorySelect');

  const postList = document.getElementById('postList');
  const postDetail = document.getElementById('postDetail');
  const postTitle = document.getElementById('postTitle');
  const postAuthor = document.getElementById('postAuthor');
  const postDate = document.getElementById('postDate');
  const postContent = document.getElementById('postContent');
  const backToListBtn = document.getElementById('backToListBtn');
const commentsList = document.getElementById('commentsList');
const commentForm = document.getElementById('commentForm');
const commentInput = document.getElementById('commentInput');

const writePostSection = document.getElementById('writePostSection');
const showWritePostBtn = document.getElementById('showWritePostBtn');
const newPostTitle = document.getElementById('newPostTitle');
const newPostContent = document.getElementById('newPostContent');
const newPostCategory = document.getElementById('newPostCategory');
const submitPostBtn = document.getElementById('submitPostBtn');
const cancelPostBtn = document.getElementById('cancelPostBtn');

// 라이트/다크 모드 전환
toggleThemeBtn.addEventListener('click', () => {
  body.classList.toggle('dark');
  body.classList.toggle('light');
  toggleThemeBtn.textContent = body.classList.contains('dark') ? '☀️' : '🌙';
});

// 사이드 메뉴 토글
burgerMenuBtn.addEventListener('click', () => {
  sideMenu.classList.toggle('open');
});

// 더미 로그인/로그아웃
let isLoggedIn = false;
function updateAuthUI() {
  loginBtn.style.display = isLoggedIn ? 'none' : 'inline-block';
  logoutBtn.style.display = isLoggedIn ? 'inline-block' : 'none';
  showWritePostBtn.style.display = isLoggedIn ? 'block' : 'none';
}
loginBtn.addEventListener('click', () => {
  isLoggedIn = true;
  updateAuthUI();
});
logoutBtn.addEventListener('click', () => {
  isLoggedIn = false;
  updateAuthUI();
});

// 게시글 리스트 예시 (더미)
let posts = [
  {
    id: 1,
    title: '환영합니다 🎉',
    content: '체르 갤러리에 오신 것을 환영합니다!',
    author: '관리자',
    date: '2025-08-01',
    category: '공지',
    comments: [],
  }
];

// 게시글 렌더링
function renderPosts() {
  postList.innerHTML = '';
  const filtered = posts.filter(post =>
    (categorySelect.value === '' || post.category === categorySelect.value) &&
    (searchInput.value === '' || post.title.includes(searchInput.value) || post.content.includes(searchInput.value))
  );
  filtered.forEach(post => {
    const li = document.createElement('li');
    li.innerHTML = `<div class="post-title">${post.title}</div><div class="post-preview">${post.content.slice(0, 40)}...</div>`;
    li.addEventListener('click', () => showPostDetail(post));
    postList.appendChild(li);
  });
}

// 게시글 상세 보기
function showPostDetail(post) {
  postDetail.style.display = 'block';
  postTitle.textContent = post.title;
  postAuthor.textContent = post.author;
  postDate.textContent = post.date;
  postContent.textContent = post.content;
  writePostSection.style.display = 'none';
  renderComments(post);
  postList.style.display = 'none';
  backToListBtn.onclick = () => {
    postDetail.style.display = 'none';
    postList.style.display = 'block';
  };
  commentForm.onsubmit = (e) => {
    e.preventDefault();
    if (!commentInput.value.trim()) return;
    post.comments.push({
      author: '익명',
      content: commentInput.value.trim(),
      createdAt: new Date().toLocaleString(),
    });
    commentInput.value = '';
    renderComments(post);
  };
}

function renderComments(post) {
  commentsList.innerHTML = '';
  post.comments.forEach(c => {
    const li = document.createElement('li');
    li.innerHTML = `
      <div class="author">${c.author}</div>
      <div class="content">${c.content}</div>
      <div class="createdAt">${c.createdAt}</div>
    `;
    commentsList.appendChild(li);
  });
}

// 글쓰기 폼
showWritePostBtn.addEventListener('click', () => {
  writePostSection.style.display = 'block';
  postDetail.style.display = 'none';
  postList.style.display = 'none';
});
cancelPostBtn.addEventListener('click', () => {
  writePostSection.style.display = 'none';
  postList.style.display = 'block';
});

submitPostBtn.addEventListener('click', () => {
  if (!newPostTitle.value.trim() || !newPostContent.value.trim()) return;
  const newPost = {
    id: posts.length + 1,
    title: newPostTitle.value.trim(),
    content: newPostContent.value.trim(),
    author: '익명',
    date: new Date().toISOString().split('T')[0],
    category: newPostCategory.value,
    comments: [],
  };
  posts.unshift(newPost);
  newPostTitle.value = '';
  newPostContent.value = '';
  newPostCategory.value = '자유';
  writePostSection.style.display = 'none';
  postList.style.display = 'block';
  renderPosts();
});

// 검색 및 필터
searchBtn.addEventListener('click', renderPosts);
categorySelect.addEventListener('change', renderPosts);

// 초기 실행
updateAuthUI();
renderPosts();
</script>
</body>
</html>
