<!DOCTYPE html>
<html lang="ko">  
<head>  
<meta charset="UTF-8" />  
<meta name="viewport" content="width=device-width, initial-scale=1" />  
<title>ì²´ë¥´ ê°¤ëŸ¬ë¦¬</title>  
<style>  
  /* ê¸°ë³¸ & ë¦¬ì…‹ */  
  * {  
    box-sizing: border-box;  
  }  
  body {  
    margin: 0 auto;  
    max-width: 480px;  
    font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, system-ui, sans-serif;  
    line-height: 1.5;  
    color: var(--text-color);  
    background-color: var(--bg-color);  
    -webkit-tap-highlight-color: transparent;  
    min-height: 100vh;  
    padding-bottom: 70px;  
    transition: background-color 0.3s ease, color 0.3s ease;  
  }  
  body.light {  
    --bg-color: #f0f2f7;  
    --text-color: #222;  
    --primary-color: #3366ff;  
    --input-bg: #fff;  
    --input-border: #c4c9dd;  
    --btn-bg: linear-gradient(135deg, #3366ff, #254eda);  
    --btn-hover-bg: linear-gradient(135deg, #254eda, #1e3bb3);  
    --modal-bg: #fff;  
    --comment-bg: #f8fbff;  
    --comment-border: #d5dbed;  
    --header-bg: #e6ebff;  
  }  
  body.dark {  
    --bg-color: #12161f;  
    --text-color: #eee;  
    --primary-color: #5599ff;  
    --input-bg: #1f2233;  
    --input-border: #394165;  
    --btn-bg: linear-gradient(135deg, #5599ff, #3366ff);  
    --btn-hover-bg: linear-gradient(135deg, #3366ff, #254eda);  
    --modal-bg: #1f2233;  
    --comment-bg: #2a2e45;  
    --comment-border: #394165;  
    --header-bg: #1e2239;  
  }  /* í—¤ë” */
header {
position: sticky;
top: 0;
background: var(--header-bg);
display: flex;
align-items: center;
padding: 10px 16px;
gap: 10px;
z-index: 150;
border-bottom: 1px solid var(--input-border);
}
header h1 {
margin: 0;
font-weight: 700;
font-size: 1.5rem;
flex-grow: 1;
user-select: none;
}

/* ë²„ê±° ë©”ë‰´ ë²„íŠ¼ */
#burgerMenuBtn {
width: 30px;
height: 24px;
border: none;
background: transparent;
cursor: pointer;
display: flex;
flex-direction: column;
justify-content: space-between;
}
#burgerMenuBtn span {
display: block;
height: 3px;
background: var(--primary-color);
border-radius: 2px;
}

/* ë¡œê·¸ì¸ ë²„íŠ¼ (ë²„ê±°ë°” ì˜†) */
#loginBtn {
padding: 6px 14px;
font-weight: 600;
font-size: 1rem;
border-radius: 6px;
border: none;
cursor: pointer;
background: var(--btn-bg);
color: white;
transition: background 0.3s;
}
#loginBtn:hover {
background: var(--btn-hover-bg);
}

/* ë¡œê·¸ì•„ì›ƒ ë²„íŠ¼ */
#logoutBtn {
padding: 6px 14px;
font-weight: 600;
font-size: 1rem;
border-radius: 6px;
border: none;
cursor: pointer;
background: var(--btn-bg);
color: white;
transition: background 0.3s;
margin-left: auto;
}
#logoutBtn:hover {
background: var(--btn-hover-bg);
}

/* ì‚¬ì´ë“œ ë©”ë‰´ */
#sideMenu {
position: fixed;
top: 0;
left: -240px;
width: 220px;
height: 100vh;
background: var(--modal-bg);
box-shadow: 2px 0 8px rgb(0 0 0 / 0.15);
padding: 20px 16px;
box-sizing: border-box;
transition: left 0.3s ease;
z-index: 200;
}
#sideMenu.open {
left: 0;
}
#sideMenu ul {
list-style: none;
padding: 0;
margin: 0;
}
#sideMenu ul li {
margin-bottom: 12px;
}
#sideMenu ul li button {
width: 100%;
padding: 10px;
border: none;
border-radius: 6px;
background: var(--btn-bg);
color: white;
font-weight: 600;
cursor: pointer;
transition: background 0.3s;
}
#sideMenu ul li button:hover {
background: var(--btn-hover-bg);
}

/* ë©”ì¸ ì˜ì—­ */
main {
padding: 10px 16px 70px;
}

/* ê²€ìƒ‰ì°½ */
#searchSection {
margin-bottom: 12px;
display: flex;
gap: 8px;
}
#searchInput {
flex-grow: 1;
padding: 10px 14px;
font-size: 1rem;
border-radius: 8px;
border: 1.5px solid var(--input-border);
background: var(--input-bg);
color: var(--text-color);
outline-offset: 2px;
}
#searchBtn {
padding: 10px 16px;
font-weight: 600;
border-radius: 8px;
border: none;
background: var(--btn-bg);
color: white;
cursor: pointer;
transition: background 0.3s;
}
#searchBtn:hover {
background: var(--btn-hover-bg);
}

/* ì¹´í…Œê³ ë¦¬ ì„ íƒ */
#categorySelect {
width: 100%;
padding: 8px 12px;
font-size: 1rem;
margin-bottom: 14px;
border-radius: 8px;
border: 1.5px solid var(--input-border);
background: var(--input-bg);
color: var(--text-color);
}

/* ê²Œì‹œê¸€ ë¦¬ìŠ¤íŠ¸ */
#postList {
list-style: none;
padding: 0;
margin: 0;
}
#postList li {
padding: 12px 16px;
border-radius: 10px;
background: var(--comment-bg);
border: 1.5px solid var(--comment-border);
margin-bottom: 12px;
cursor: pointer;
font-weight: 600;
display: flex;
flex-direction: column;
transition: background 0.2s, color 0.2s;
}
#postList li:hover {
background: var(--primary-color);
color: white;
}
#postList li .post-title {
font-weight: 700;
font-size: 1.1rem;
margin-bottom: 6px;
}
#postList li .post-preview {
font-weight: 400;
font-size: 0.9rem;
color: #666;
}

/* ê²Œì‹œê¸€ ìƒì„¸ */
#postDetail {
display: none;
margin-top: 20px;
}
#postDetail h3 {
margin-top: 0;
font-weight: 700;
}
#postDetail .post-meta {
font-size: 0.85rem;
color: #777;
margin-bottom: 12px;
}
#postContent {
white-space: pre-wrap;
margin-bottom: 20px;
}
#backToListBtn {
background: transparent;
border: none;
color: var(--primary-color);
font-weight: 600;
cursor: pointer;
margin-bottom: 20px;
}
#backToListBtn:hover {
text-decoration: underline;
}

/* ëŒ“ê¸€ ì„¹ì…˜ */
#commentsSection {
margin-top: 30px;
}
#commentsSection h4 {
margin-bottom: 12px;
font-weight: 600;
}
#commentsList {
list-style: none;
padding: 0;
margin: 0;
max-height: 240px;
overflow-y: auto;
}
#commentsList li {
background: var(--comment-bg);
border: 1px solid var(--comment-border);
border-radius: 8px;
padding: 12px 16px;
margin-bottom: 10px;
}
#commentsList li .author {
font-weight: 700;
font-size: 0.9rem;
margin-bottom: 6px;
}
#commentsList li .content {
white-space: pre-wrap;
font-size: 0.95rem;
}
#commentsList li .createdAt {
font-size: 0.75rem;
color: #777;
margin-top: 6px;
}

/* ëŒ“ê¸€ ì‘ì„± í¼ */
#commentForm {
display: flex;
margin-top: 14px;
}
#commentInput {
flex-grow: 1;
padding: 10px 14px;
border: 1.5px solid var(--input-border);
border-radius: 8px 0 0 8px;
font-size: 1rem;
background: var(--input-bg);
color: var(--text-color);
outline-offset: 2px;
}
#commentSubmitBtn {
padding: 0 20px;
background: var(--btn-bg);
border: none;
color: white;
font-weight: 700;
border-radius: 0 8px 8px 0;
cursor: pointer;
transition: background 0.3s;
}
#commentSubmitBtn:hover {
background: var(--btn-hover-bg);
}

/* ìƒˆ ê¸€ ì‘ì„± ë²„íŠ¼ - ì˜¤ë¥¸ìª½ í•˜ë‹¨ ê³ ì • */
#showWritePostBtn {
position: fixed;
bottom: 20px;
right: 20px;
background: var(--btn-bg);
border: none;
color: white;
padding: 14px 22px;
font-weight: 700;
font-size: 1.1rem;
border-radius: 50px;
cursor: pointer;
box-shadow: 0 4px 12px rgb(0 0 0 / 0.2);
transition: background 0.3s, transform 0.15s;
z-index: 90;
}
#showWritePostBtn:hover {
background: var(--btn-hover-bg);
transform: scale(1.05);
}
#showWritePostBtn:active {
transform: scale(0.95);
}

/* ì˜¤ë¥˜ ë©”ì‹œì§€ */
.errorMsg {
color: #e53e3e;
font-size: 0.85rem;
margin-bottom: 8px;
text-align: center;
}

</style>  
</head>  
<body class="light">  
<header>  
  <button id="burgerMenuBtn" aria-label="ë©”ë‰´ ì—´ê¸°" aria-expanded="false" aria-controls="sideMenu">  
    <span></span>  
    <span></span>  
    <span></span>  
  </button>  
  <h1>ì²´ë¥´ ê°¤ëŸ¬ë¦¬</h1>  
  <button id="loginBtn" style="display:none;">ë¡œê·¸ì¸</button>  
  <button id="logoutBtn" style="display:none;">ë¡œê·¸ì•„ì›ƒ</button>  
</header>  

<!-- ì‚¬ì´ë“œ ë©”ë‰´ -->  
<nav id="sideMenu" aria-hidden="true" tabindex="-1">  
  <ul>  
    <li><button>ì„ì‹œ ë²„íŠ¼1</button></li>  
    <li><button>ì„ì‹œ ë²„íŠ¼2</button></li>  
    <li><button>ì„ì‹œ ë²„íŠ¼3</button></li>  
  </ul>  
</nav>  

<main>  
  <!-- ê²€ìƒ‰ + ì¹´í…Œê³ ë¦¬ -->  
  <section id="searchSection">  
    <input id="searchInput" type="search" placeholder="ê²Œì‹œë¬¼ ê²€ìƒ‰" aria-label="ê²Œì‹œë¬¼ ê²€ìƒ‰" />  
    <button id="searchBtn" aria-label="ê²€ìƒ‰ ì‹¤í–‰">ê²€ìƒ‰</button>  
  </section>    

  <select id="categorySelect" aria-label="ì¹´í…Œê³ ë¦¬ ì„ íƒ">  
    <option value="">ì „ì²´ ì¹´í…Œê³ ë¦¬</option>  
    <option value="ììœ ">ììœ </option>  
    <option value="ê³µì§€">ê³µì§€</option>  
    <option value="ì§ˆë¬¸">ì§ˆë¬¸</option>  
  </select>    

  <!-- ê²Œì‹œê¸€ ë¦¬ìŠ¤íŠ¸ -->    
  <ul id="postList" aria-live="polite" aria-relevant="additions"></ul>    

  <!-- ê²Œì‹œê¸€ ìƒì„¸ -->    
  <article id="postDetail" tabindex="-1" aria-label="ê²Œì‹œê¸€ ìƒì„¸ ë³´ê¸°">  
    <button id="backToListBtn">&lt; ëª©ë¡ìœ¼ë¡œ</button>  
    <h3 id="postTitle"></h3>  
    <div class="post-meta">ì‘ì„±ì: <span id="postAuthor"></span> | ì‘ì„±ì¼: <span id="postDate"></span></div>  
    <div id="postContent"></div>  

    <!-- ëŒ“ê¸€ ì„¹ì…˜ -->  
    <section id="commentsSection" aria-label="ëŒ“ê¸€ ì„¹ì…˜">  
      <h4>ëŒ“ê¸€</h4>  
      <ul id="commentsList"></ul>  
      <form id="commentForm">  
        <input id="commentInput" placeholder="ëŒ“ê¸€ ì‘ì„±..." autocomplete="off" aria-label="ëŒ“ê¸€ ë‚´ìš© ì…ë ¥" />  
        <button id="commentSubmitBtn" type="submit">ë“±ë¡</button>  
      </form>  
    </section>

  </article>    

  <!-- ê²Œì‹œê¸€ ì‘ì„± -->    
  <section id="writePostSection" aria-label="ê²Œì‹œê¸€ ì‘ì„±" style="display:none;">  
    <input type="text" id="newPostTitle" placeholder="ì œëª©" aria-label="ìƒˆ ê²Œì‹œë¬¼ ì œëª©" />  
    <textarea id="newPostContent" placeholder="ë‚´ìš©" aria-label="ìƒˆ ê²Œì‹œë¬¼ ë‚´ìš©"></textarea>  
    <select id="newPostCategory" aria-label="ì¹´í…Œê³ ë¦¬ ì„ íƒ">  
      <option value="ììœ ">ììœ </option>  
      <option value="ê³µì§€">ê³µì§€</option>  
      <option value="ì§ˆë¬¸">ì§ˆë¬¸</option>  
    </select>  
    <div class="btn-group">  
      <button id="submitPostBtn">ê¸€ ì‘ì„±</button>  
      <button id="cancelPostBtn" class="cancel-btn">ì·¨ì†Œ</button>  
    </div>  
  </section>  
</main>  

<!-- ìƒˆ ê¸€ ì‘ì„± ë²„íŠ¼ -->  
<button id="showWritePostBtn" title="ìƒˆ ê¸€ ì‘ì„±">ê¸€ì“°ê¸° âœï¸</button>

<!-- ë¼ì´íŠ¸/ë‹¤í¬ ëª¨ë“œ í† ê¸€ -->  
<button id="toggleThemeBtn" title="ë¼ì´íŠ¸ / ë‹¤í¬ ëª¨ë“œ ì „í™˜" style="position: fixed; top: 10px; left: 10px; z-index: 110;">ğŸŒ™</button>

<script>  
  const SERVER_URL = 'http://foxbox.r-e.kr'; // http ì£¼ì†Œë¡œ ë³€ê²½  
  
  // DOM ìš”ì†Œ  
  const body = document.body;  
  const toggleThemeBtn = document.getElementById('toggleThemeBtn');  
  
  const burgerMenuBtn = document.getElementById('burgerMenuBtn');  
  const sideMenu = document.getElementById('sideMenu');  
  
  const loginBtn = document.getElementById('loginBtn');  
  const logoutBtn = document.getElementById('logoutBtn');  
  
  const searchInput = document.getElementById('searchInput');  
  const searchBtn = document.getElementById('searchBtn');  
  const categorySelect = document.getElementById('categorySelect');  
  
  const postList = document.getElementById('postList');  
  const postDetail = document.getElementById('postDetail');  
  const postTitle = document.getElementById('postTitle');  
  const postAuthor = document.getElementById('postAuthor');  
  const postDate = document.getElementById('postDate');  
  const postContent = document.getElementById('postContent');  
  const backToListBtn = document.getElementById('backToListBtn');  
  
  // ì—¬ê¸° ì˜¤ë¥˜ ìˆ˜ì •ëœ ë¶€ë¶„: ë³€ìˆ˜ ì„ ì–¸ ì˜¬ë°”ë¥´ê²Œ  
  const commentsList = document.getElementById('commentsList');  
  const commentForm = document.getElementById('commentForm');  
  const commentInput = document.getElementById('commentInput');  
  const commentSubmitBtn = document.getElementById('commentSubmitBtn');  
  
  const writePostSection = document.getElementById('writePostSection');  
  const newPostTitle = document.getElementById('newPostTitle');  
  const newPostContent = document.getElementById('newPostContent');  
  const newPostCategory = document.getElementById('newPostCategory');  
  const submitPostBtn = document.getElementById('submitPostBtn');  
  const cancelPostBtn = document.getElementById('cancelPostBtn');  
  
  const showWritePostBtn = document.getElementById('showWritePostBtn');  
  
  let currentUser = null;  
  let currentPostId = null;  
  let posts = [];  
  
  // ë¼ì´íŠ¸/ë‹¤í¬ ëª¨ë“œ ì´ˆê¸° ì„¤ì •  
  function loadTheme() {  
    const savedTheme = localStorage.getItem('theme');  
    if (savedTheme === 'dark') {  
      body.classList.remove('light');  
      body.classList.add('dark');  
      toggleThemeBtn.textContent = 'â˜€ï¸';  
    } else {  
      body.classList.remove('dark');  
      body.classList.add('light');  
      toggleThemeBtn.textContent = 'ğŸŒ™';  
    }  
  }  
  loadTheme();  
  
  toggleThemeBtn.addEventListener('click', () => {  
    if (body.classList.contains('light')) {  
      body.classList.replace('light', 'dark');  
      toggleThemeBtn.textContent = 'â˜€ï¸';  
      localStorage.setItem('theme', 'dark');  
    } else {  
      body.classList.replace('dark', 'light');  
      toggleThemeBtn.textContent = 'ğŸŒ™';  
      localStorage.setItem('theme', 'light');  
    }  
  });  
  
  // ì‚¬ì´ë“œ ë©”ë‰´ ì—´ê¸°/ë‹«ê¸°  
  burgerMenuBtn.addEventListener('click', () => {  
    const isOpen = sideMenu.classList.toggle('open');  
    burgerMenuBtn.setAttribute('aria-expanded', isOpen ? 'true' : 'false');  
    sideMenu.setAttribute('aria-hidden', !isOpen);  
    if (isOpen) sideMenu.focus();  
  });  
  
  // ë¡œê·¸ì¸ ìƒíƒœ UI ì—…ë°ì´íŠ¸  
  function updateAuthUI() {  
    if (currentUser) {  
      loginBtn.style.display = 'none';  
      logoutBtn.style.display = 'inline-block';  
    } else {  
      loginBtn.styleloginBtn.style.display = 'inline-block';  
      logoutBtn.style.display = 'none';  
    }  
  }  
  
  // ë¡œê·¸ì¸ ì²˜ë¦¬ (ê°„ë‹¨ í¼ íŒì—…)  
  async function login() {  
    const username = prompt('ì•„ì´ë””ë¥¼ ì…ë ¥í•˜ì„¸ìš”');  
    if (!username) return alert('ì•„ì´ë””ë¥¼ ì…ë ¥í•´ì•¼ í•©ë‹ˆë‹¤.');  
  
    const password = prompt('ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”');  
    if (!password) return alert('ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì•¼ í•©ë‹ˆë‹¤.');  
  
    try {  
      const res = await fetch(`${SERVER_URL}/api/login`, {  
        method: 'POST',  
        headers: { 'Content-Type': 'application/json' },  
        body: JSON.stringify({ username, password })  
      });  
      if (!res.ok) throw new Error('ë¡œê·¸ì¸ ì‹¤íŒ¨');  
      const data = await res.json();  
      localStorage.setItem('token', data.token);  
      currentUser = username;  
      updateAuthUI();  
      alert('ë¡œê·¸ì¸ ì„±ê³µ');  
      loadPosts();  
    } catch (e) {  
      alert('ë¡œê·¸ì¸ ì‹¤íŒ¨: ' + e.message);  
    }  
  }  
  
  // ë¡œê·¸ì•„ì›ƒ ì²˜ë¦¬  
  function logout() {  
    localStorage.removeItem('token');  
    currentUser = null;  
    updateAuthUI();  
    showPostList();  
  }  
  
  loginBtn.addEventListener('click', login);  
  logoutBtn.addEventListener('click', logout);  
  
  // í† í° ì²´í¬ ë° ì‚¬ìš©ì ì •ë³´ ì„¤ì •  
  function checkAuth() {  
    const token = localStorage.getItem('token');  
    if (token) {  
      // ì‹¤ì œ ì„œë²„ì—ì„œ í† í° í™•ì¸ í›„ ì‚¬ìš©ì ì´ë¦„ ë°›ì•„ì™€ì•¼ í•˜ì§€ë§Œ ê°„ë‹¨íˆ ì €ì¥ëœ í† í° ìˆìœ¼ë©´ ë¡œê·¸ì¸ ìƒíƒœë¡œ ì²˜ë¦¬  
      currentUser = 'ì‚¬ìš©ì'; // ì„ì‹œ ì´ë¦„  
    } else {  
      currentUser = null;  
    }  
    updateAuthUI();  
  }  
  
  // ê²Œì‹œê¸€ ëª©ë¡ ë¶ˆëŸ¬ì˜¤ê¸°  
  async function loadPosts() {  
    try {  
      let url = `${SERVER_URL}/api/posts`;  
      const category = categorySelect.value;  
      const search = searchInput.value.trim();  
      const params = new URLSearchParams();  
      if (category) params.append('category', category);  
      if (search) params.append('search', search);  
      if ([...params].length > 0) url += `?${params.toString()}`;  
  
      const res = await fetch(url);  
      if (!res.ok) throw new Error('ê²Œì‹œê¸€ ë¶ˆëŸ¬ì˜¤ê¸° ì‹¤íŒ¨');  
      posts = await res.json();  
      renderPostList();  
    } catch (e) {  
      alert('ê²Œì‹œê¸€ ë¶ˆëŸ¬ì˜¤ê¸° ì‹¤íŒ¨: ' + e.message);  
    }  
  }  
  
  // ê²Œì‹œê¸€ ë¦¬ìŠ¤íŠ¸ ë Œë”ë§  
  function renderPostList() {  
    postList.innerHTML = '';  
    if (posts.length === 0) {  
      postList.innerHTML = '<li>ê²Œì‹œê¸€ì´ ì—†ìŠµë‹ˆë‹¤.</li>';  
      return;  
    }  
    posts.forEach(post => {  
      const li = document.createElement('li');  
      li.tabIndex = 0;  
      li.setAttribute('role', 'button');  
      li.setAttribute('aria-pressed', 'false');  
      li.innerHTML = `<div class="post-title">${post.title}</div><div class="post-preview">${post.content.substring(0, 50)}...</div>`;  
      li.addEventListener('click', () => showPostDetail(post.id));  
      li.addEventListener('keypress', e => {  
        if (e.key === 'Enter' || e.key === ' ') {  
          e.preventDefault();  
          showPostDetail(post.id);  
        }  
      });  
      postList.appendChild(li);  
    });  
  }  
  
  // ê²Œì‹œê¸€ ìƒì„¸ ë³´ê¸°  
  async function showPostDetail(id) {  
    const post = posts.find(p => p.id === id);  
    if (!post) return;  
    currentPostId = id;  
    postTitle.textContent = post.title;  
    postAuthor.textContent = post.author || 'ìµëª…';  
    postDate.textContent = new Date(post.createdAt).toLocaleString();  
    postContent.textContent = post.content;  
  
    postList.style.display = 'none';  
    writePostSection.style.display = 'none';  
    postDetail.style.display = 'block';  
  
    await loadComments(id);  
    commentInput.value = '';  
    commentInput.disabled = !currentUser;  
    commentSubmitBtn.disabled = !currentUser;  
  
    postDetail.focus();  
  }  
  
  // ê²Œì‹œê¸€ ëª©ë¡ ë³´ê¸°ë¡œ ì „í™˜  
  function showPostList() {  
    currentPostId = null;  
    postDetail.style.display = 'none';  
    writePostSection.style.display = 'none';  
    postList.style.display = 'block';  
  }  
  
  backToListBtn.addEventListener('click', showPostList);  
  
  // ëŒ“ê¸€ ë¶ˆëŸ¬ì˜¤ê¸°  
  async function loadComments(postId) {  
    try {  
      const res = await fetch(`${SERVER_URL}/api/posts/${postId}/comments`);  
      if (!res.ok) throw new Error('ëŒ“ê¸€ ë¶ˆëŸ¬ì˜¤ê¸° ì‹¤íŒ¨');  
      const comments = await res.json();  
  
      commentsList.innerHTML = '';  
      if (comments.length === 0) {  
        commentsList.innerHTML = '<li>ëŒ“ê¸€ì´ ì—†ìŠµë‹ˆë‹¤.</li>';  
        return;  
      }  
  
      comments.forEach(comment => {  
        const li = document.createElement('li');  
        li.innerHTML = `<div class="author">${comment.author || 'ìµëª…'}</div><div class="content">${comment.content}</div><div class="createdAt">${new Date(comment.createdAt).toLocaleString()}</div>`;  
        commentsList.appendChild(li);  
      });  
    } catch (e) {  
      alert('ëŒ“ê¸€ ë¶ˆëŸ¬ì˜¤ê¸° ì‹¤íŒ¨: ' + e.message);  
    }  
  }  
  
  // ëŒ“ê¸€ ì‘ì„±  
  commentForm.addEventListener('submit', async (e) => {  
    e.preventDefault();  
    if (!currentUser) {  
      alert('ë¡œê·¸ì¸ í›„ ëŒ“ê¸€ ì‘ì„±ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.');  
      return;  
    }  
    const content = commentInput.value.trim();  
    if (!content) {  
      alert('ëŒ“ê¸€ ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”.');  
      return;  
    }  
  
    try {  
      const token = localStorage.getItem('token');  
      const res = await fetch(`${SERVER_URL}/api/posts/${currentPostId}/comments`, {  
        method: 'POST',  
        headers: {  
          'Content-Type': 'application/json',  
          'Authorization': `Bearer ${token}`  
        },  
        body: JSON.stringify({ content })  
      });  
      if (!res.ok) throw new Error('ëŒ“ê¸€ ì‘ì„± ì‹¤íŒ¨');  
      commentInput.value = '';  
      await loadComments(currentPostId);  
    } catch (e) {  
      alert('ëŒ“ê¸€ ì‘ì„± ì‹¤íŒ¨: ' + e.message);  
    }  
  });  
  
  // ìƒˆ ê¸€ ì‘ì„± UI ë³´ì´ê¸°  
  showWritePostBtn.addEventListener('click', () => {  
    postList.style.display = 'none';  
    postDetail.style.display = 'none';  
    writePostSection.style.display = 'block';  
    newPostTitle.value = '';  
    newPostContent.value = '';  
    newPostCategory.value = 'ììœ ';  
  });  
  
  // ìƒˆ ê¸€ ì‘ì„± ì·¨ì†Œ  
  cancelPostBtn.addEventListener('click', () => {  
    writePostSection.style.display = 'none';  
    showPostList();  
  });  
  
  // ìƒˆ ê¸€ ì‘ì„± ì œì¶œ  
  submitPostBtn.addEventListener('click', async () => {  
    if (!currentUser) {  
      alert('ë¡œê·¸ì¸ í›„ ê¸€ ì‘ì„±ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.');  
      return;  
    }  
    const title = newPostTitle.value.trim();  
    const content = newPostContent.value.trim();  
    const category = newPostCategory.value;  
  
    if (!title || !content) {  
      alert('ì œëª©ê³¼ ë‚´ìš©ì„ ëª¨ë‘ ì…ë ¥í•˜ì„¸ìš”.');  
      return;  
    }  
  
    try {  
      const token = localStorage.getItem('token');  
      const res = await fetch(`${SERVER_URL}/api/posts`, {  
        method: 'POST',  
        headers: {  
          'Content-Type': 'application/json',  
          'Authorization': `Bearer ${token}`  
        },  
        body: JSON.stringify({ title, content, category })  
      });  
      if (!res.ok) throw new Error('ê¸€ ì‘ì„± ì‹¤íŒ¨');  
      alert('ê¸€ì´ ì‘ì„±ë˜ì—ˆìŠµë‹ˆë‹¤.');  
      writePostSection.style.display = 'none';  
      loadPosts();  
      showPostList();  
    } catch (e) {  
      alert('ê¸€ ì‘ì„± ì‹¤íŒ¨: ' + e.message);  
    }  
  });  
  
  // ì¹´í…Œê³ ë¦¬ ì„ íƒ ë° ê²€ìƒ‰ ë²„íŠ¼ ì´ë²¤íŠ¸  
  categorySelect.addEventListener('change', loadPosts);  
  searchBtn.addEventListener('click', loadPosts);  
  
  // ì´ˆê¸° ì‹¤í–‰  
  checkAuth();  
  loadPosts();  
</script>  
</body>  
</html>
